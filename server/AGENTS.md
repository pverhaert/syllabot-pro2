# Server-Side Agents: Implementation Details

The server-side logic of Syllabot Pro 2 is built around a set of specialized AI agents that interact with Large Language Models (LLMs) like Google Gemini, Groq, Cerebras, and OpenRouter.

## Agent Architecture

All server-side agents inherit from the `BaseAgent` abstract class, which provides common functionality for:
-   **Text Generation:** Synchronous and streaming generation.
-   **JSON Generation:** Enforcing structured output for JSON schemas.
-   **Context Management:** Accessing the `PipelineContext` (course config, LLM client, model ID).
-   **Logging:** Emitting "thinking" logs via Socket.io to the client for real-time visualization.

### Core Agent Classes

#### `BaseAgent`
-   **ID:** `base-agent`
-   **Role:** Abstract base class for all server-side agents.
-   **Common Methods:** `generateText()`, `generateJSON<T>()`, `generateStream()`, `log()`.

#### `OutlineCreatorAgent`
-   **ID:** `outline-agent`
-   **Role:** Designs the course structure.
-   **Input:** Topic, target audience, and number of chapters.
-   **Output:** `CourseOutline` (JSON object including title, description, and list of chapters with IDs and titles).

#### `CourseNameAgent`
-   **ID:** `course-name-agent`
-   **Role:** Generates a creative name for the course based on the topic and generated outline.
-   **Input:** Topic and course structure.
-   **Output:** Plain text string (the course title).

#### `ChapterWriterAgent`
-   **ID:** `chapter-agent`
-   **Role:** Writes the main educational content for a specific chapter.
-   **Input:** Topic, target audience, writing style, and chapter goals.
-   **Output:** High-quality Markdown text.

#### `ExerciseCreatorAgent`
-   **ID:** `exercise-agent`
-   **Role:** Generates practical exercises with solutions and explanations.
-   **Input:** Chapter content and desired difficulty level.
-   **Output:** Array of `Exercise` objects (question, solution, why, difficulty).

#### `QuizCreatorAgent`
-   **ID:** `quiz-agent`
-   **Role:** Creates multiple-choice quiz questions with feedback.
-   **Input:** Chapter content.
-   **Output:** Array of `QuizQuestion` objects (question, options, correctAnswerIndex, explanation).

## Orchestration Flow

The `CourseOrchestrator` manages the pipeline:
1.  **Start Outline Generation:** Triggers the `OutlineCreatorAgent` and `CourseNameAgent`.
2.  **Chapter Generation:** Iteratively calls the `ChapterWriterAgent`, `ExerciseCreatorAgent`, and `QuizCreatorAgent` for each chapter.
3.  **Persistence:** Saves progress to the `FileStore` (state and Markdown history).
4.  **Streaming:** Emits events to the client to update the UI and visualize progress.

## Technology Stack (Server)
-   **TypeScript:** Type-safe development.
-   **Express / Socket.io:** Real-time API communication.
-   **Google GenAI SDK:** Support for Gemini 1.5/2.0 models.
-   **Groq SDK:** High-performance inference for Llama 3 models.
-   **OpenRouter / Cerebras:** Extensible model access.
-   **Mermaid CLI:** Renders diagrams generated by agents within the course content.
